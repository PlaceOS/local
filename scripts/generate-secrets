#! /usr/bin/env bash
# shellcheck disable=1091

# Path of installation directory
base_path="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd)/../"

source "${base_path}/.env.email"

image="${PLACE_INIT_REGISTRY:-docker.io}/placeos/init:${PLACE_INIT_TAG:-latest}"

docker pull "${image}"

docker run --rm \
    -w /tmp/secrets \
    -v "${base_path}:/tmp/secrets" \
    -e PLACE_EMAIL="${PLACE_EMAIL}" \
    -e PLACE_PASSWORD="${PLACE_PASSWORD}" \
    -- "${image}" generate-secrets
